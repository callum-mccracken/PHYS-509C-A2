\section{\texorpdfstring{CO$_2$}{CO2} Meter}

If we assume that the data follows an exponential plateau, approaching some steady state value C, then that means for any $t$ our expected $y$ (concentration in ppm) is
\begin{align*}
    y = C - B e^{-At}
\end{align*}

To include the error as a fit parameter, let's say (since we have no other reason to pick a different distribution) that for every $t$ we have a Gaussian distribution with mean $\mu = C - B e^{-At}$ and standard deviation $\sigma_y$.

With that, we can calculate the likelihood:

\begin{align*}
    L &= \prod P(x_i, y_i, A, B, C, \sigma_y) \\
    -\ln(L) &= -\sum P_i \\
    -\ln(L) &= -\sum \frac{1}{\sqrt{2\pi}\sigma_y}\exp\left(-\frac{\left(y_i - C - B e^{-At}\right)^2}{2\sigma^2}\right) \\
\end{align*}

We only care about $C$ and $\sigma$ though, marginalize the others:
\begin{align*}
    P(x_i, y_i, A, C, \sigma_y) &= \int_B P(B) P(x_i, y_i, A, B, C, \sigma_y) dB \\
    &= \int_{-\infty}^\infty 1 P(x_i, y_i, A, B, C, \sigma_y) dB \\
    &= \int_{-\infty}^\infty 1 P(x_i, y_i, A, B, C, \sigma_y) dB \\
\end{align*}

To minimize this, set all the derivatives with respect to parameters equal to zero.
\begin{align*}
    &\frac{\d}{\d C}-\sum \frac{1}{\sqrt{2\pi}\sigma_y}\exp\left(-\frac{\left(y_i - C - B e^{-At_i}\right)^2}{2\sigma^2}\right) \\
    &=-\sum \frac{1}{\sqrt{2\pi}\sigma_y}\frac{\d}{\d C}e^{-\left(y_i - C - B e^{-At_i}\right)^2}e^{-2\sigma^2} \\
    &=\sum \frac{1}{\sqrt{2\pi}\sigma_y}e^{-\left(y_i - C - B e^{-At_i}\right)^2}e^{-2\sigma^2}\frac{\d}{\d C}\left(y_i - C - B e^{-At_i}\right)^2 \\
    &=\sum \frac{1}{\sqrt{2\pi}\sigma_y}e^{-\left(y_i - C - B e^{-At_i}\right)^2}e^{-2\sigma^2}2\left(y_i - C - B e^{-At_i}\right)(-1) \\
    &=-\sum \frac{1}{\sqrt{2\pi}\sigma_y}\exp\left(-\frac{\left(y_i - C - B e^{-At_i}\right)^2}{2\sigma^2}\right)2\left(y_i - C - B e^{-At_i}\right) \\
\end{align*}


\begin{align*}
    &\frac{\d}{\d B}-\sum \frac{1}{\sqrt{2\pi}\sigma_y}\exp\left(-\frac{\left(y_i - C - B e^{-At_i}\right)^2}{2\sigma^2}\right) \\
    &=-\sum \frac{1}{\sqrt{2\pi}\sigma_y}\frac{\d}{\d C}e^{-\left(y_i - C - B e^{-At_i}\right)^2}e^{-2\sigma^2} \\
    &=\sum \frac{1}{\sqrt{2\pi}\sigma_y}e^{-\left(y_i - C - B e^{-At_i}\right)^2}e^{-2\sigma^2}\frac{\d}{\d C}\left(y_i - C - B e^{-At_i}\right)^2 \\
    &=\sum \frac{1}{\sqrt{2\pi}\sigma_y}e^{-\left(y_i - C - B e^{-At_i}\right)^2}e^{-2\sigma^2}2\left(y_i - C - B e^{-At_i}\right)(-1) \\
    &=-\sum \frac{1}{\sqrt{2\pi}\sigma_y}\exp\left(-\frac{\left(y_i - C - B e^{-At_i}\right)^2}{2\sigma^2}\right)2\left(y_i - C - B e^{-At_i}\right) \\
\end{align*}




\todo{How much of that uncertainty can be attributed to the time binning (measurements are only reported to the nearest minute)?}
